<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Results</title>
    <link rel="stylesheet" href="style/style_result.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet"> 
</head>
<body>
    <header>
    </header>
    <a href="index.html"><button class="button">Back to homepage</button></a>
    <main>
      <div class="summary">
          <h2>Results</h2>
          <p><mark>You will break even at <span id="bep"></span> units</mark></p>          
          <p>At expected unit sales, which is <span id="exp"></span> units:</p>              
          <p>Total Revenue: $<span id="tot_revenue"></span></p>
          <p>Total Cost: $<span id="tot_cost"></span></p>
          <p>Net Profit: $<span id="net"></span></p>
      </div>


      <div class="tableview">
          <table id="table">
            <tr>                
                <th>Units</th>
                <th>Variabel Costs</th>
                <th>Total Costs</th>
                <th>Total Revenue</th>
                <th>Net Profit</th>
            </tr>
            
          </table>          
      </div>


      <div class="chart" style="width: 800px;">
          <h2>Break-Even Analysis Chart</h2>
          <canvas id="myChart"></canvas>
          <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>   
          <script>
              //codingan table
              //cetak data di summary
              document.getElementById("exp").innerHTML=localStorage.getItem("expectedus");
              
              //deklarasi variabel
              FixedCosts = parseInt(localStorage.getItem("textvalue"))
              VariableCosts = parseInt(localStorage.getItem("varcost"));
              SellingPriceUnit = parseInt(localStorage.getItem("sellprice"));
              ExpectedUnitSales = parseInt(localStorage.getItem("expectedus"));
              TotalRow = ExpectedUnitSales/1000 + 1;
              
              // Create one dimensional array
              var BEParray = new Array(TotalRow);
              
              // Loop to create 2D array using 1D array      
              for (var i = 0; i < BEParray.length; i++) {
                  BEParray[i] = [];
              }
              var h = 0;              
              // Loop to initialize 2D array elements.
              for (var UnitSale = 0; UnitSale <= TotalRow; UnitSale +=1000){
                  for (var i = 0; i < TotalRow; i++) {
                      BEParray[i][0] = UnitSale;
                      BEParray[i][1] = UnitSale * VariableCosts;
                      BEParray[i][2] = (UnitSale * VariableCosts) + FixedCosts;
                      BEParray[i][3] = UnitSale * SellingPriceUnit;
                      BEParray[i][4] = UnitSale * SellingPriceUnit - (UnitSale * VariableCosts + FixedCosts);                      
                      UnitSale = UnitSale + parseInt(1000);
                      if (BEParray[i][4]== 0 ) {
                        document.getElementById("bep").innerHTML=BEParray[i][0];                        
                      }
                      if (BEParray[i][0]==ExpectedUnitSales)  {
                        document.getElementById("tot_revenue").innerHTML=BEParray[i][2];
                        document.getElementById("tot_cost").innerHTML=BEParray[i][3];
                        document.getElementById("net").innerHTML=BEParray[i][4];
                      }                  
                  }
              }
              
              var array = BEParray,
                table = document.getElementById("table");               
                  
              for(var i = 0; i < array.length; i++)
              {
                  // create a new row
                  var newRow = table.insertRow(table.length);
                  for(var j = 0; j < array[i].length; j++)
                  {
                      // create a new cell
                      var cell = newRow.insertCell(j);
                      
                      // add value to the cell
                      cell.innerHTML = array[i][j];
                  }
              }
              
              BEPtranpose = BEParray[0].map((_, colIndex) => BEParray.map(row => row[colIndex]));
              //codingan chart
              const labels = BEPtranpose[0];
            
              const data = {
                labels: labels,
                datasets: [
                {
                  label: 'Variable Costs',
                  backgroundColor: '#1991D0',
                  borderColor: '#1991D0',
                  data: BEPtranpose[1],
                },
                {
                  label: 'Total Costs',
                  backgroundColor: '#F05B4F',
                  borderColor: '#F05B4F',
                  data: BEPtranpose[2],
                },
                {
                  label: 'Total Revenue',
                  backgroundColor: '#F5CF5B',
                  borderColor: '#F5CF5B',
                  data: BEPtranpose[3],
                },
                {
                  label: 'Net Profit',
                  backgroundColor: '#2ECC71',
                  borderColor: '#2ECC71',
                  data: BEPtranpose[4],
                },
              ]
              };
                      
              const config = {
                type: 'line',
                data: data,
                options: {}
              };
          </script>
          <script>
              const myChart = new Chart(
                document.getElementById('myChart'),
                config
              );
          </script>                    
      </div>
    </main>


    <footer>
      <div class="grid-container">
        <div>
          <p>Property of Kelompok 1: Milda Safrila O | M Rafi Rahmat A | Raja M Rifqi SH | Syafli Shovin</p>
        </div>
        <div style="text-align: right;">
          <p>MSIB 2018 | Komputerisasi Akuntansi</p>
        </div>
    </footer>
    
    
    <script>
      
    </script>


</body>
</html>